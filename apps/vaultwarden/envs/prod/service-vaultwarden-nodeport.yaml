apiVersion: v1
kind: Service
metadata:
  name: vaultwarden-nodeport
  namespace: vaultwarden  # Ensure this is in the same namespace as your deployment
  labels:
    app.kubernetes.io/component: vaultwarden
    app.kubernetes.io/instance: vaultwarden
    app.kubernetes.io/name: vaultwarden  # Keep these labels consistent for easier management
spec:
  type: NodePort
  selector:
    app.kubernetes.io/component: vaultwarden
    app.kubernetes.io/instance: vaultwarden
    app.kubernetes.io/name: vaultwarden  # Must match the labels of your Pods/Deployment
  ports:
    - name: http
      port: 80  # Port exposed by the service *within* the cluster.  Clients inside the cluster can still use this port.
      targetPort: 8080  # The port your application *inside* the container is listening on.
      protocol: TCP
      nodePort: 30080  #  Choose a port in the 30000-32767 range.  This is the port exposed on *each node*.